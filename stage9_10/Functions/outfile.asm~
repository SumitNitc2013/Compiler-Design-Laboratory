START
MOV BP, 0
MOV SP, 104
CALL main
HALT
main:
PUSH BP
MOV BP, SP
MOV R0, 0
MOV R1, SP
ADD R1, R0 
MOV SP, R1
MOV R0, 0
IN R1
MOV [R0], R1
MOV R0, 101
MOV R1, 0
MOV [R0], R1
L1:
MOV R0, [101]
MOV R1, [0]
LT R0, R1
MOV R1, 0
NE R0, R1
JZ R0, L2
MOV R0, [101]
MOV R1, 1
ADD R0, R1
IN R1
MOV [R0], R1
MOV R0, 101
MOV R1, [101]
MOV R2, 1
ADD R1, R2
MOV [R0], R1
JMP L1
L2:
MOV R0, 102
IN R1
MOV [R0], R1
MOV R0, 103
IN R1
MOV [R0], R1
MOV R0, 101
MOV R1, 0
MOV [R0], R1
L3:
MOV R0, [101]
MOV R1, [0]
LT R0, R1
MOV R1, 0
NE R0, R1
JZ R0, L4
MOV R0, [101]
MOV R1, 1
ADD R0, R1
MOV R0, [R0]
MOV R1, [102]
GE R0, R1
MOV R1, 0
EQ R0, R1
JNZ R0, L6
MOV R2, [101]
MOV R3, 1
ADD R2, R3
MOV R2, [R2]
MOV R3, [103]
LE R2, R3
MOV R3, 0
EQ R2, R3
JNZ R2, L6
MOV R2, 1
JMP L7
L6:
MOV R2, 0
L7:
MOV R3, 0
NE R2, R3
JZ R2, L5
MOV R2, [101]
MOV R3, 1
ADD R2, R3
MOV R2, [R2]
OUT R2
L5:
MOV R2, 101
MOV R3, [101]
MOV R4, 1
ADD R3, R4
MOV [R2], R3
JMP L3
L4:
MOV R3, 0
MOV R4, -2
MOV R5, BP
ADD R4, R5
MOV [R4], R3
MOV R3, 0
MOV R4, SP
SUB R4, R3 
MOV SP, R4
POP BP
RET
